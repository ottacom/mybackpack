 isi version > /tmp/uPdInFo && isi status -q >> /tmp/uPdInFo && isi_classic firmware status >> /tmp/uPdInFo && echo SyncIQ target check >> /tmp/uPdInFo&& isi sync target list >> /tmp/uPdInFo && echo SyncIQ policy check >> /tmp/uPdInFo && isi sync pol list >> /tmp/uPdInFo && echo Serials and Product >> /tmp/uPdInFo && isi_for_array -s 'isi_hw_status -i | grep -E "SerNo|Product"' >> /tmp/uPdInFo && echo BMC Info >> /tmp/uPdInFo && isi_for_array -s '/usr/bin/isi_hwtools/isi_ipmicmc -d -V -a bmc 2>/dev/null'>> /tmp/uPdInFo;perl -e '$old=$bmc=$src=$tgt=0;open (F,"<","/tmp/uPdInFo");while (<F>){if(/Isilon OneFS\s+(v.*?)\s+/){$OneFS=$1};if(/\s+CMC\s+([\d\w\.]+?)\s+/){$CMC.="$1 "};if(/^Cluster Name:\s+(.*)$/){$cluname=$1}if(/^SyncIQ target check/){$tctl=1;next};if($tctl && /^Total:\s+(\d+)/){$tgt=$1;$tctl=0} if(/^SyncIQ policy check/){$sctl=1;next};if($sctl && /^Total:\s+(\d+)/){$src=$1;$sctl=0} if(/.*?(\d+):\s+SerNo:\s+(.*)/){$n=$1;$sn=$2};if(/Product:\s+(.*)/){$product.=sprintf("%-4s%-18s %s\n",$n,$sn,$1)};$older++ if(/unsupported/);if(/IPMI firmware version\s+=\s+(\d+\.\d+)/){$bmc++;$rfw++ if($1 ne '01.25');};}close(F);print "Please copy the output from here !!\nCluster Name\t\t$cluname\nOneFS version\t\t$OneFS\nCMC Versions\t\t$CMC\nSyncIQ Target\t\t$tgt\nSyncIQ Source\t\t$src\nNon-Gen5 Nodes\t\t$older\nGen5 Nodes\t\t$bmc\n# nodes to BMC upgrade\t".($bmc-$rfw)."\nEst. Drain time\t\t".($bmc*20)." minutes\nEst. BMC Update time\t".(($bmc-$rfw)*5)." minutes\n\nSerials & Products\n$product\n"';rm -f /tmp/uPdInFo
